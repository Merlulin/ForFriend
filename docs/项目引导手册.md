# V3 Admin Vite é¡¹ç›®å¼•å¯¼æ‰‹å†Œ

> æœ¬æ‰‹å†Œæ—¨åœ¨å¸®åŠ©äºŒæ¬¡å¼€å‘çš„åˆå­¦è€…å¿«é€Ÿäº†è§£é¡¹ç›®ç»“æ„ã€æŠ€æœ¯æ ˆã€å¼€å‘è§„èŒƒï¼Œå¹¶æä¾›å®ç”¨çš„å¼€å‘æŒ‡å—å’Œç¤ºä¾‹ã€‚

---

## ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#1-é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ ˆ](#2-æŠ€æœ¯æ ˆ)
3. [ç›®å½•ç»“æ„](#3-ç›®å½•ç»“æ„)
4. [å¿«é€Ÿå¼€å§‹](#4-å¿«é€Ÿå¼€å§‹)
5. [å¼€å‘è§„èŒƒ](#5-å¼€å‘è§„èŒƒ)
6. [æ ¸å¿ƒåŠŸèƒ½æ¨¡å—](#6-æ ¸å¿ƒåŠŸèƒ½æ¨¡å—)
7. [äºŒæ¬¡å¼€å‘æŒ‡å—](#7-äºŒæ¬¡å¼€å‘æŒ‡å—)
8. [å¸¸ç”¨ç»„åˆå¼å‡½æ•°](#8-å¸¸ç”¨ç»„åˆå¼å‡½æ•°)
9. [ç»†èŠ‚æç¤ºä¸æœ€ä½³å®è·µ](#9-ç»†èŠ‚æç¤ºä¸æœ€ä½³å®è·µ)

---

## 1. é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯åŸºäº **V3 Admin Vite** æ¨¡æ¿æ„å»ºçš„ä¸­åå°ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨ Vue 3 + TypeScript + Vite æŠ€æœ¯æ ˆï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- ğŸš€ **ç°ä»£åŒ–æŠ€æœ¯æ ˆ**ï¼šVue 3.5 + Vite 7 + TypeScript 5
- ğŸ“¦ **å¼€ç®±å³ç”¨**ï¼šå†…ç½®ä¸°å¯Œçš„ç»„ä»¶å’ŒåŠŸèƒ½æ¨¡å—
- ğŸ¨ **å¤šç§å¸ƒå±€æ¨¡å¼**ï¼šæ”¯æŒå·¦ä¾§ã€é¡¶éƒ¨ã€æ··åˆä¸‰ç§å¸ƒå±€
- ğŸ” **æƒé™ç®¡ç†**ï¼šæ”¯æŒé¡µé¢çº§å’ŒæŒ‰é’®çº§æƒé™æ§åˆ¶
- ğŸ¯ **åŸå­åŒ– CSS**ï¼šé›†æˆ UnoCSSï¼Œå¿«é€Ÿç¼–å†™æ ·å¼
- ğŸ“Š **æ•°æ®è¡¨æ ¼**ï¼šé›†æˆ Element Plus å’Œ Vxe Table åŒè¡¨æ ¼æ–¹æ¡ˆ

---

## 2. æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶

| æŠ€æœ¯       | ç‰ˆæœ¬  | è¯´æ˜                          |
| ---------- | ----- | ----------------------------- |
| Vue        | 3.5.x | æ¸è¿›å¼ JavaScript æ¡†æ¶        |
| Vue Router | 4.6.x | Vue.js å®˜æ–¹è·¯ç”±               |
| Pinia      | 3.0.x | Vue.js å®˜æ–¹çŠ¶æ€ç®¡ç†           |
| TypeScript | 5.9.x | JavaScript è¶…é›†ï¼Œæä¾›ç±»å‹æ”¯æŒ |

### æ„å»ºå·¥å…·

| æŠ€æœ¯   | ç‰ˆæœ¬  | è¯´æ˜               |
| ------ | ----- | ------------------ |
| Vite   | 7.3.x | ä¸‹ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…· |
| UnoCSS | 66.x  | åŸå­åŒ– CSS å¼•æ“    |
| ESLint | 9.x   | ä»£ç è§„èŒƒæ£€æŸ¥å·¥å…·   |

### UI ç»„ä»¶åº“

| æŠ€æœ¯                    | ç‰ˆæœ¬   | è¯´æ˜                |
| ----------------------- | ------ | ------------------- |
| Element Plus            | 2.13.x | Vue 3 ç»„ä»¶åº“        |
| Vxe Table               | 4.6.x  | é«˜æ€§èƒ½è¡¨æ ¼ç»„ä»¶      |
| @element-plus/icons-vue | 2.3.x  | Element Plus å›¾æ ‡åº“ |

### å·¥å…·åº“

| æŠ€æœ¯       | è¯´æ˜           |
| ---------- | -------------- |
| Axios      | HTTP è¯·æ±‚åº“    |
| Day.js     | æ—¥æœŸå¤„ç†åº“     |
| Lodash-es  | å®ç”¨å·¥å…·å‡½æ•°åº“ |
| NProgress  | è¿›åº¦æ¡ç»„ä»¶     |
| Screenfull | å…¨å±åŠŸèƒ½åº“     |

---

## 3. ç›®å½•ç»“æ„

```
ForFriend/
â”œâ”€â”€ docs/                        # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ public/                      # é™æ€èµ„æºï¼ˆä¸ä¼šè¢«æ„å»ºå¤„ç†ï¼‰
â”œâ”€â”€ src/                         # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ common/                  # é€šç”¨æ¨¡å—ï¼ˆå¯è·¨é¡¹ç›®å¤ç”¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ apis/                # API æ¥å£å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ tables/          # è¡¨æ ¼ç›¸å…³æ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ users/           # ç”¨æˆ·ç›¸å…³æ¥å£
â”‚   â”‚   â”œâ”€â”€ assets/              # é™æ€èµ„æº
â”‚   â”‚   â”‚   â”œâ”€â”€ icons/           # SVG å›¾æ ‡
â”‚   â”‚   â”‚   â”œâ”€â”€ images/          # å›¾ç‰‡èµ„æº
â”‚   â”‚   â”‚   â””â”€â”€ styles/          # å…¨å±€æ ·å¼
â”‚   â”‚   â”œâ”€â”€ components/          # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ composables/         # ç»„åˆå¼å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ constants/           # å¸¸é‡å®šä¹‰
â”‚   â”‚   â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ http/                    # HTTP è¯·æ±‚å°è£…
â”‚   â”‚   â””â”€â”€ axios.ts             # Axios å®ä¾‹å’Œæ‹¦æˆªå™¨
â”‚   â”œâ”€â”€ layouts/                 # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ components/          # å¸ƒå±€å­ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ composables/         # å¸ƒå±€ç›¸å…³ç»„åˆå¼å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ modes/               # å¸ƒå±€æ¨¡å¼ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ config.ts            # å¸ƒå±€é…ç½®
â”‚   â”‚   â””â”€â”€ index.vue            # å¸ƒå±€å…¥å£
â”‚   â”œâ”€â”€ pages/                   # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ dashboard/           # ä»ªè¡¨ç›˜é¡µé¢
â”‚   â”‚   â”œâ”€â”€ demo/                # ç¤ºä¾‹é¡µé¢
â”‚   â”‚   â”œâ”€â”€ error/               # é”™è¯¯é¡µé¢ï¼ˆ403ã€404ï¼‰
â”‚   â”‚   â”œâ”€â”€ login/               # ç™»å½•é¡µé¢
â”‚   â”‚   â””â”€â”€ redirect/            # é‡å®šå‘é¡µé¢
â”‚   â”œâ”€â”€ pinia/                   # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ stores/              # Store å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ app.ts           # åº”ç”¨çŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ permission.ts    # æƒé™çŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ settings.ts      # è®¾ç½®çŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ tags-view.ts     # æ ‡ç­¾æ çŠ¶æ€
â”‚   â”‚   â”‚   â””â”€â”€ user.ts          # ç”¨æˆ·çŠ¶æ€
â”‚   â”‚   â””â”€â”€ index.ts             # Pinia å®ä¾‹
â”‚   â”œâ”€â”€ plugins/                 # æ’ä»¶
â”‚   â”‚   â”œâ”€â”€ element-plus-icons.ts # Element Plus å›¾æ ‡æ³¨å†Œ
â”‚   â”‚   â”œâ”€â”€ permission-directive.ts # æƒé™æŒ‡ä»¤
â”‚   â”‚   â”œâ”€â”€ svg-icon.ts          # SVG å›¾æ ‡ç»„ä»¶
â”‚   â”‚   â””â”€â”€ vxe-table.ts         # Vxe Table é…ç½®
â”‚   â”œâ”€â”€ router/                  # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ config.ts            # è·¯ç”±é…ç½®é¡¹
â”‚   â”‚   â”œâ”€â”€ guard.ts             # è·¯ç”±å®ˆå«
â”‚   â”‚   â”œâ”€â”€ helper.ts            # è·¯ç”±è¾…åŠ©å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ index.ts             # è·¯ç”±å®šä¹‰
â”‚   â”‚   â””â”€â”€ whitelist.ts         # ç™½åå•é…ç½®
â”‚   â”œâ”€â”€ App.vue                  # æ ¹ç»„ä»¶
â”‚   â””â”€â”€ main.ts                  # åº”ç”¨å…¥å£
â”œâ”€â”€ tests/                       # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ types/                       # TypeScript ç±»å‹å£°æ˜
â”‚   â”œâ”€â”€ api.d.ts                 # API å“åº”ç±»å‹
â”‚   â”œâ”€â”€ env.d.ts                 # ç¯å¢ƒå˜é‡ç±»å‹
â”‚   â””â”€â”€ auto/                    # è‡ªåŠ¨ç”Ÿæˆçš„ç±»å‹å£°æ˜
â”œâ”€â”€ eslint.config.js             # ESLint é…ç½®
â”œâ”€â”€ index.html                   # HTML æ¨¡æ¿
â”œâ”€â”€ package.json                 # é¡¹ç›®é…ç½®
â”œâ”€â”€ tsconfig.json                # TypeScript é…ç½®
â”œâ”€â”€ uno.config.ts                # UnoCSS é…ç½®
â””â”€â”€ vite.config.ts               # Vite é…ç½®
```

### é‡è¦ç›®å½•è¯´æ˜

#### `src/common/` - é€šç”¨æ¨¡å—

æ­¤ç›®å½•åŒ…å«å¯è·¨é¡¹ç›®å¤ç”¨çš„ä»£ç ï¼Œä½¿ç”¨ `@@` åˆ«åå¼•ç”¨ï¼š

```typescript
import { usePagination } from "@@/composables/usePagination"
import { getToken } from "@@/utils/local-storage"
```

#### `src/pages/` - é¡µé¢ç»„ä»¶

æ‰€æœ‰ä¸šåŠ¡é¡µé¢éƒ½æ”¾åœ¨æ­¤ç›®å½•ï¼Œæ¯ä¸ªé¡µé¢å¯åŒ…å«ï¼š

- `index.vue` - é¡µé¢ä¸»ç»„ä»¶
- `components/` - é¡µé¢ç§æœ‰ç»„ä»¶
- `apis/` - é¡µé¢ä¸“ç”¨æ¥å£
- `composables/` - é¡µé¢ä¸“ç”¨ç»„åˆå¼å‡½æ•°
- `images/` - é¡µé¢ä¸“ç”¨å›¾ç‰‡

---

## 4. å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Node.js**: >= 18.0.0
- **pnpm**: >= 8.0.0ï¼ˆæ¨èä½¿ç”¨ pnpmï¼‰

### å®‰è£…ä¾èµ–

```bash
pnpm install
```

### å¼€å‘å‘½ä»¤

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm build

# æ„å»ºæµ‹è¯•ç‰ˆæœ¬
pnpm build:staging

# é¢„è§ˆæ„å»ºç»“æœ
pnpm preview

# ä»£ç æ£€æŸ¥ä¸ä¿®å¤
pnpm lint

# è¿è¡Œæµ‹è¯•
pnpm test
```

### å¼€å‘æœåŠ¡å™¨é…ç½®

å¼€å‘æœåŠ¡å™¨é»˜è®¤é…ç½®ï¼ˆå¯åœ¨ `vite.config.ts` ä¸­ä¿®æ”¹ï¼‰ï¼š

- **ç«¯å£**: 3333
- **è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨**: æ˜¯
- **API ä»£ç†**: `/api/v1` ä»£ç†åˆ° Mock æœåŠ¡

---

## 5. å¼€å‘è§„èŒƒ

### 5.1 ä»£ç é£æ ¼

é¡¹ç›®ä½¿ç”¨ **@antfu/eslint-config** è¿›è¡Œä»£ç è§„èŒƒçº¦æŸï¼š

```javascript
// eslint.config.js ä¸»è¦è§„åˆ™
{
  stylistic: {
    indent: 2,           // 2 ç©ºæ ¼ç¼©è¿›
    quotes: "double",    // åŒå¼•å·
    semi: false          // ä¸ä½¿ç”¨åˆ†å·
  }
}
```

### 5.2 Vue ç»„ä»¶è§„èŒƒ

#### ç»„ä»¶ç»“æ„é¡ºåº

```vue
<script lang="ts" setup>
// 1. ç±»å‹å¯¼å…¥
import type { FormRules } from "element-plus"

// 2. ç»„ä»¶/å‡½æ•°å¯¼å…¥
import { usePagination } from "@@/composables/usePagination"

// 3. ç»„ä»¶é€‰é¡¹
defineOptions({
  name: "ComponentName" // å‘½åç»„ä»¶ï¼ˆç”¨äº keep-alive ç¼“å­˜ï¼‰
})

// 4. Props å’Œ Emits
const props = defineProps<{}>()
const emit = defineEmits<{}>()

// 5. å“åº”å¼çŠ¶æ€
const loading = ref(false)
const formData = reactive({})

// 6. è®¡ç®—å±æ€§
const computedValue = computed(() => {})

// 7. æ–¹æ³•
function handleClick() {}

// 8. ç”Ÿå‘½å‘¨æœŸé’©å­
onMounted(() => {})

// 9. ç›‘å¬å™¨
watch(() => {}, () => {})
</script>

<template>
  <!-- æ¨¡æ¿å†…å®¹ -->
</template>

<style lang="scss" scoped>
/* ç»„ä»¶æ ·å¼ */
</style>
```

#### ç»„ä»¶å‘½åè§„èŒƒ

- **é¡µé¢ç»„ä»¶**: ä½¿ç”¨ `index.vue` ä½œä¸ºå…¥å£
- **ä¸šåŠ¡ç»„ä»¶**: ä½¿ç”¨ PascalCaseï¼Œå¦‚ `UserTable.vue`
- **ç»„ä»¶ name**: å¿…é¡»è®¾ç½®ï¼Œç”¨äº keep-alive ç¼“å­˜å’Œè°ƒè¯•

```typescript
defineOptions({
  name: "ElementPlus" // ä¸è·¯ç”± meta.keepAlive é…åˆä½¿ç”¨
})
```

### 5.3 è·¯å¾„åˆ«å

é¡¹ç›®é…ç½®äº†ä¸¤ä¸ªè·¯å¾„åˆ«åï¼š

| åˆ«å | å®é™…è·¯å¾„      | ç”¨é€”                  |
| ---- | ------------- | --------------------- |
| `@`  | `src/`        | å¼•ç”¨ src ç›®å½•ä¸‹çš„æ–‡ä»¶ |
| `@@` | `src/common/` | å¼•ç”¨é€šç”¨æ¨¡å—          |

```typescript
import { usePagination } from "@@/composables/usePagination"
// ç¤ºä¾‹
import { useUserStore } from "@/pinia/stores/user"
```

### 5.4 API æ¥å£è§„èŒƒ

#### æ¥å£æ–‡ä»¶ç»“æ„

```
src/common/apis/
â””â”€â”€ tables/
    â”œâ”€â”€ index.ts    # æ¥å£å‡½æ•°
    â””â”€â”€ type.ts     # ç±»å‹å®šä¹‰
```

#### æ¥å£å‡½æ•°å®šä¹‰

```typescript
// src/common/apis/tables/index.ts
import type * as Tables from "./type"
import { request } from "@/http/axios"

/** å¢ */
export function createTableDataApi(data: Tables.CreateOrUpdateTableRequestData) {
  return request({
    url: "tables",
    method: "post",
    data
  })
}

/** æŸ¥ */
export function getTableDataApi(params: Tables.TableRequestData) {
  return request<Tables.TableResponseData>({
    url: "tables",
    method: "get",
    params
  })
}
```

#### ç±»å‹å®šä¹‰

```typescript
// src/common/apis/tables/type.ts
export interface CreateOrUpdateTableRequestData {
  id?: number
  username: string
  password?: string
}

export interface TableData {
  id: number
  username: string
  // ...å…¶ä»–å­—æ®µ
}

// ä½¿ç”¨å…¨å±€ ApiResponseData ç±»å‹
export type TableResponseData = ApiResponseData<{
  list: TableData[]
  total: number
}>
```

#### API å“åº”æ ¼å¼

æ‰€æœ‰ API æ¥å£åº”éµå¾ªç»Ÿä¸€çš„å“åº”æ ¼å¼ï¼š

```typescript
// types/api.d.ts
interface ApiResponseData<T> {
  code: number // ä¸šåŠ¡çŠ¶æ€ç ï¼Œ0 è¡¨ç¤ºæˆåŠŸ
  data: T // å“åº”æ•°æ®
  message: string // æç¤ºä¿¡æ¯
}
```

---

## 6. æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 6.1 è·¯ç”±ç³»ç»Ÿ

#### è·¯ç”±ç±»å‹

1. **å¸¸é©»è·¯ç”±** (`constantRoutes`)ï¼šæ‰€æœ‰ç”¨æˆ·éƒ½å¯è®¿é—®
2. **åŠ¨æ€è·¯ç”±** (`dynamicRoutes`)ï¼šéœ€è¦æƒé™éªŒè¯çš„è·¯ç”±

#### è·¯ç”± Meta é…ç½®

```typescript
meta: {
  title: "é¡µé¢æ ‡é¢˜",           // é¡µé¢æ ‡é¢˜ï¼Œæ˜¾ç¤ºåœ¨èœå•å’Œæ ‡ç­¾æ 
  svgIcon: "dashboard",        // SVG å›¾æ ‡åç§°ï¼ˆäºŒé€‰ä¸€ï¼‰
  elIcon: "DataBoard",         // Element Plus å›¾æ ‡åç§°ï¼ˆäºŒé€‰ä¸€ï¼‰
  hidden: true,                // æ˜¯å¦åœ¨èœå•ä¸­éšè—
  roles: ["admin", "editor"],  // å…è®¸è®¿é—®çš„è§’è‰²
  keepAlive: true,             // æ˜¯å¦ç¼“å­˜é¡µé¢
  affix: true,                 // æ˜¯å¦å›ºå®šåœ¨æ ‡ç­¾æ 
  alwaysShow: true             // æ˜¯å¦æ€»æ˜¯æ˜¾ç¤ºï¼ˆå³ä½¿åªæœ‰ä¸€ä¸ªå­è·¯ç”±ï¼‰
}
```

#### æ·»åŠ æ–°è·¯ç”±ç¤ºä¾‹

```typescript
// src/router/index.ts
export const constantRoutes: RouteRecordRaw[] = [
  // ...å…¶ä»–è·¯ç”±
  {
    path: "/my-module",
    component: Layouts,
    redirect: "/my-module/list",
    name: "MyModule",
    meta: {
      title: "æˆ‘çš„æ¨¡å—",
      elIcon: "Menu"
    },
    children: [
      {
        path: "list",
        component: () => import("@/pages/my-module/list.vue"),
        name: "MyModuleList",
        meta: {
          title: "åˆ—è¡¨é¡µ"
        }
      },
      {
        path: "detail/:id",
        component: () => import("@/pages/my-module/detail.vue"),
        name: "MyModuleDetail",
        meta: {
          title: "è¯¦æƒ…é¡µ",
          hidden: true // è¯¦æƒ…é¡µä¸åœ¨èœå•æ˜¾ç¤º
        }
      }
    ]
  }
]
```

### 6.2 æƒé™ç³»ç»Ÿ

#### é¡µé¢çº§æƒé™

é€šè¿‡è·¯ç”± `meta.roles` æ§åˆ¶ï¼š

```typescript
{
  path: "admin-page",
  component: () => import("@/pages/admin/index.vue"),
  meta: {
    title: "ç®¡ç†å‘˜é¡µé¢",
    roles: ["admin"]  // åªæœ‰ admin è§’è‰²å¯è®¿é—®
  }
}
```

#### æŒ‰é’®çº§æƒé™

ä½¿ç”¨ `v-permission` æŒ‡ä»¤ï¼š

```vue
<template>
  <!-- åªæœ‰ admin è§’è‰²å¯è§ -->
  <el-button v-permission="['admin']">
    åˆ é™¤
  </el-button>

  <!-- admin æˆ– editor è§’è‰²å¯è§ -->
  <el-button v-permission="['admin', 'editor']">
    ç¼–è¾‘
  </el-button>
</template>
```

### 6.3 çŠ¶æ€ç®¡ç†

#### Store ç»“æ„

| Store                | ç”¨é€”                     |
| -------------------- | ------------------------ |
| `useUserStore`       | ç”¨æˆ·ä¿¡æ¯ã€ç™»å½•çŠ¶æ€       |
| `useSettingsStore`   | ç³»ç»Ÿè®¾ç½®ï¼ˆå¸ƒå±€ã€ä¸»é¢˜ç­‰ï¼‰ |
| `usePermissionStore` | æƒé™å’Œè·¯ç”±               |
| `useTagsViewStore`   | æ ‡ç­¾æ ç®¡ç†               |
| `useAppStore`        | åº”ç”¨çŠ¶æ€ï¼ˆä¾§è¾¹æ ç­‰ï¼‰     |

#### ä½¿ç”¨ç¤ºä¾‹

```typescript
import { useUserStore } from "@/pinia/stores/user"

// åœ¨ setup å¤–ä½¿ç”¨
import { useUserStoreOutside } from "@/pinia/stores/user"

// åœ¨ setup ä¸­ä½¿ç”¨
const userStore = useUserStore()
console.log(userStore.username)
console.log(userStore.roles)
const userStore = useUserStoreOutside()
```

### 6.4 HTTP è¯·æ±‚

#### è¯·æ±‚å°è£…

é¡¹ç›®ä½¿ç”¨ Axios å¹¶è¿›è¡Œäº†å°è£…ï¼Œè‡ªåŠ¨å¤„ç†ï¼š

- Token æºå¸¦
- ç»Ÿä¸€é”™è¯¯å¤„ç†
- ä¸šåŠ¡çŠ¶æ€ç åˆ¤æ–­
- ç™»å½•å¤±æ•ˆè·³è½¬

#### ä½¿ç”¨æ–¹å¼

```typescript
import { request } from "@/http/axios"

// GET è¯·æ±‚
const response = await request<ResponseType>({
  url: "api/endpoint",
  method: "get",
  params: { key: "value" }
})

// POST è¯·æ±‚
const response = await request({
  url: "api/endpoint",
  method: "post",
  data: { key: "value" }
})
```

---

## 7. äºŒæ¬¡å¼€å‘æŒ‡å—

### 7.1 æ–°å¢ä¸šåŠ¡é¡µé¢

ä»¥åˆ›å»ºã€Œç”¨æˆ·ç®¡ç†ã€é¡µé¢ä¸ºä¾‹ï¼š

#### æ­¥éª¤ 1ï¼šåˆ›å»ºé¡µé¢ç›®å½•ç»“æ„

```
src/pages/user-management/
â”œâ”€â”€ index.vue           # ä¸»é¡µé¢
â”œâ”€â”€ components/         # é¡µé¢ç»„ä»¶
â”‚   â””â”€â”€ UserForm.vue   # ç”¨æˆ·è¡¨å•ç»„ä»¶
â””â”€â”€ apis/              # é¡µé¢æ¥å£ï¼ˆå¯é€‰ï¼Œä¹Ÿå¯ä½¿ç”¨ common/apisï¼‰
    â”œâ”€â”€ index.ts
    â””â”€â”€ type.ts
```

#### æ­¥éª¤ 2ï¼šåˆ›å»ºé¡µé¢ç»„ä»¶

```vue
<!-- src/pages/user-management/index.vue -->
<script lang="ts" setup>
import type { TableData } from "@@/apis/tables/type"
import { deleteTableDataApi, getTableDataApi } from "@@/apis/tables"
import { usePagination } from "@@/composables/usePagination"
import { CirclePlus, Delete, Refresh, Search } from "@element-plus/icons-vue"

defineOptions({
  name: "UserManagement"
})

const loading = ref(false)
const tableData = ref<TableData[]>([])

const { paginationData, handleCurrentChange, handleSizeChange } = usePagination()

// æœç´¢è¡¨å•
const searchFormRef = useTemplateRef("searchFormRef")
const searchData = reactive({
  username: "",
  phone: ""
})

// è·å–è¡¨æ ¼æ•°æ®
async function getTableData() {
  loading.value = true
  try {
    const { data } = await getTableDataApi({
      currentPage: paginationData.currentPage,
      size: paginationData.pageSize,
      username: searchData.username,
      phone: searchData.phone
    })
    tableData.value = data.list
    paginationData.total = data.total
  } finally {
    loading.value = false
  }
}

// æœç´¢
function handleSearch() {
  paginationData.currentPage === 1 ? getTableData() : (paginationData.currentPage = 1)
}

// é‡ç½®æœç´¢
function resetSearch() {
  searchFormRef.value?.resetFields()
  handleSearch()
}

// åˆ é™¤
async function handleDelete(row: TableData) {
  await ElMessageBox.confirm(`ç¡®è®¤åˆ é™¤ç”¨æˆ·ï¼š${row.username}ï¼Ÿ`, "æç¤º", {
    type: "warning"
  })
  await deleteTableDataApi(row.id)
  ElMessage.success("åˆ é™¤æˆåŠŸ")
  getTableData()
}

// ç›‘å¬åˆ†é¡µå˜åŒ–
watch(
  [() => paginationData.currentPage, () => paginationData.pageSize],
  getTableData,
  { immediate: true }
)
</script>

<template>
  <div class="app-container">
    <!-- æœç´¢åŒºåŸŸ -->
    <el-card shadow="never" class="mb-5">
      <el-form ref="searchFormRef" :inline="true" :model="searchData">
        <el-form-item prop="username" label="ç”¨æˆ·å">
          <el-input v-model="searchData.username" placeholder="è¯·è¾“å…¥" clearable />
        </el-form-item>
        <el-form-item prop="phone" label="æ‰‹æœºå·">
          <el-input v-model="searchData.phone" placeholder="è¯·è¾“å…¥" clearable />
        </el-form-item>
        <el-form-item>
          <el-button type="primary" :icon="Search" @click="handleSearch">
            æŸ¥è¯¢
          </el-button>
          <el-button :icon="Refresh" @click="resetSearch">
            é‡ç½®
          </el-button>
        </el-form-item>
      </el-form>
    </el-card>

    <!-- è¡¨æ ¼åŒºåŸŸ -->
    <el-card v-loading="loading" shadow="never">
      <div class="flex justify-between mb-5">
        <el-button type="primary" :icon="CirclePlus">
          æ–°å¢ç”¨æˆ·
        </el-button>
      </div>

      <el-table :data="tableData" border>
        <el-table-column prop="username" label="ç”¨æˆ·å" align="center" />
        <el-table-column prop="phone" label="æ‰‹æœºå·" align="center" />
        <el-table-column prop="email" label="é‚®ç®±" align="center" />
        <el-table-column prop="status" label="çŠ¶æ€" align="center">
          <template #default="{ row }">
            <el-tag :type="row.status ? 'success' : 'danger'">
              {{ row.status ? "å¯ç”¨" : "ç¦ç”¨" }}
            </el-tag>
          </template>
        </el-table-column>
        <el-table-column label="æ“ä½œ" width="150" align="center">
          <template #default="{ row }">
            <el-button type="primary" text size="small">
              ç¼–è¾‘
            </el-button>
            <el-button type="danger" text size="small" @click="handleDelete(row)">
              åˆ é™¤
            </el-button>
          </template>
        </el-table-column>
      </el-table>

      <!-- åˆ†é¡µ -->
      <div class="flex justify-end mt-5">
        <el-pagination
          v-model:current-page="paginationData.currentPage"
          v-model:page-size="paginationData.pageSize"
          :page-sizes="paginationData.pageSizes"
          :total="paginationData.total"
          layout="total, sizes, prev, pager, next, jumper"
          @size-change="handleSizeChange"
          @current-change="handleCurrentChange"
        />
      </div>
    </el-card>
  </div>
</template>

<style lang="scss" scoped>
// ä½¿ç”¨ UnoCSSï¼Œæ ·å¼å¯ä»¥ç®€åŒ–
</style>
```

#### æ­¥éª¤ 3ï¼šé…ç½®è·¯ç”±

```typescript
// src/router/index.ts
{
  path: "/user-management",
  component: Layouts,
  redirect: "/user-management/index",
  children: [
    {
      path: "index",
      component: () => import("@/pages/user-management/index.vue"),
      name: "UserManagement",
      meta: {
        title: "ç”¨æˆ·ç®¡ç†",
        elIcon: "User",
        keepAlive: true
      }
    }
  ]
}
```

### 7.2 æ–°å¢ API æ¥å£

#### æ­¥éª¤ 1ï¼šåˆ›å»ºç±»å‹å®šä¹‰

```typescript
// src/common/apis/users/type.ts
export interface UserInfo {
  id: number
  username: string
  email: string
  phone: string
  avatar: string
  roles: string[]
}

export interface UserListParams {
  currentPage: number
  size: number
  username?: string
}

export type UserListResponse = ApiResponseData<{
  list: UserInfo[]
  total: number
}>

export type UserDetailResponse = ApiResponseData<UserInfo>
```

#### æ­¥éª¤ 2ï¼šåˆ›å»ºæ¥å£å‡½æ•°

```typescript
// src/common/apis/users/index.ts
import type * as Users from "./type"
import { request } from "@/http/axios"

/** è·å–ç”¨æˆ·åˆ—è¡¨ */
export function getUserListApi(params: Users.UserListParams) {
  return request<Users.UserListResponse>({
    url: "users",
    method: "get",
    params
  })
}

/** è·å–ç”¨æˆ·è¯¦æƒ… */
export function getUserDetailApi(id: number) {
  return request<Users.UserDetailResponse>({
    url: `users/${id}`,
    method: "get"
  })
}

/** åˆ›å»ºç”¨æˆ· */
export function createUserApi(data: Partial<Users.UserInfo>) {
  return request({
    url: "users",
    method: "post",
    data
  })
}

/** æ›´æ–°ç”¨æˆ· */
export function updateUserApi(data: Users.UserInfo) {
  return request({
    url: "users",
    method: "put",
    data
  })
}

/** åˆ é™¤ç”¨æˆ· */
export function deleteUserApi(id: number) {
  return request({
    url: `users/${id}`,
    method: "delete"
  })
}
```

### 7.3 æ–°å¢è‡ªå®šä¹‰å›¾æ ‡

#### SVG å›¾æ ‡

1. å°† SVG æ–‡ä»¶æ”¾å…¥ `src/common/assets/icons/` ç›®å½•
2. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ï¼š

```vue
<template>
  <!-- ä½¿ç”¨ SvgIcon ç»„ä»¶ -->
  <SvgIcon name="dashboard" />

  <!-- åœ¨è·¯ç”± meta ä¸­ä½¿ç”¨ -->
  <!-- meta: { svgIcon: "dashboard" } -->
</template>
```

#### ä¿æŒåŸè‰²å›¾æ ‡

å°†éœ€è¦ä¿æŒåŸè‰²çš„ SVG æ”¾å…¥ `src/common/assets/icons/preserve-color/` ç›®å½•ã€‚

### 7.4 è‡ªå®šä¹‰ä¸»é¢˜

#### ä¿®æ”¹ CSS å˜é‡

åœ¨ `src/common/assets/styles/` ä¸­ä¿®æ”¹ï¼š

```scss
// ä¿®æ”¹ä¸»é¢˜è‰²
:root {
  --el-color-primary: #409eff;
}
```

#### æ·»åŠ æ–°ä¸»é¢˜

åœ¨ `src/common/composables/useTheme.ts` ä¸­æ·»åŠ ï¼š

```typescript
export type ThemeName = DefaultThemeName | "dark" | "dark-blue" | "my-theme"

const themeList: ThemeList[] = [
  // ...å·²æœ‰ä¸»é¢˜
  {
    title: "æˆ‘çš„ä¸»é¢˜",
    name: "my-theme"
  }
]
```

---

## 8. å¸¸ç”¨ç»„åˆå¼å‡½æ•°

é¡¹ç›®åœ¨ `src/common/composables/` ä¸­æä¾›äº†å¤šä¸ªå¯å¤ç”¨çš„ç»„åˆå¼å‡½æ•°ï¼š

### usePagination

åˆ†é¡µé€»è¾‘å°è£…ï¼š

```typescript
import { usePagination } from "@@/composables/usePagination"

const { paginationData, handleCurrentChange, handleSizeChange } = usePagination()

// è‡ªå®šä¹‰åˆå§‹å€¼
const { paginationData } = usePagination({
  pageSize: 20,
  pageSizes: [10, 20, 50, 100]
})
```

### useFetchSelect

ä¸‹æ‹‰é€‰æ‹©å™¨æ•°æ®è·å–ï¼š

```typescript
import { useFetchSelect } from "@@/composables/useFetchSelect"

const { loading, options, value } = useFetchSelect({
  api: () => getOptionsApi()
})
```

### useFullscreenLoading

å…¨å± Loadingï¼š

```typescript
import { useFullscreenLoading } from "@@/composables/useFullscreenLoading"

const { startLoading, endLoading } = useFullscreenLoading()

async function handleSubmit() {
  startLoading()
  try {
    await submitApi()
  } finally {
    endLoading()
  }
}
```

### useWatermark

æ°´å°åŠŸèƒ½ï¼š

```typescript
import { useWatermark } from "@@/composables/useWatermark"

const { setWatermark, clearWatermark } = useWatermark()

// è®¾ç½®æ°´å°
setWatermark("æœºå¯†æ–‡æ¡£")

// æ¸…é™¤æ°´å°
clearWatermark()
```

### useDevice

è®¾å¤‡æ£€æµ‹ï¼š

```typescript
import { useDevice } from "@@/composables/useDevice"

const { isMobile } = useDevice()
```

### useLayoutMode

å¸ƒå±€æ¨¡å¼ï¼š

```typescript
import { useLayoutMode } from "@@/composables/useLayoutMode"

const { isLeft, isTop, isLeftTop } = useLayoutMode()
```

---

## 9. ç»†èŠ‚æç¤ºä¸æœ€ä½³å®è·µ

### 9.1 è‡ªåŠ¨å¯¼å…¥

é¡¹ç›®é…ç½®äº†è‡ªåŠ¨å¯¼å…¥ï¼Œä»¥ä¸‹ API æ— éœ€æ‰‹åŠ¨ importï¼š

- **Vue**: `ref`, `reactive`, `computed`, `watch`, `onMounted` ç­‰
- **Vue Router**: `useRoute`, `useRouter` ç­‰
- **Pinia**: `defineStore`, `storeToRefs` ç­‰
- **Element Plus**: ç»„ä»¶è‡ªåŠ¨æŒ‰éœ€å¯¼å…¥

### 9.2 UnoCSS å¿«æ·æ–¹å¼

é¡¹ç›®é¢„å®šä¹‰äº†å¸¸ç”¨çš„ CSS å¿«æ·æ–¹å¼ï¼š

```vue
<template>
  <!-- å®½é«˜100% -->
  <div class="wh-full" />

  <!-- æ°´å¹³å‚ç›´å±…ä¸­ -->
  <div class="flex-center" />

  <!-- ä»…æ°´å¹³å±…ä¸­ -->
  <div class="flex-x-center" />

  <!-- ä»…å‚ç›´å±…ä¸­ -->
  <div class="flex-y-center" />
</template>
```

### 9.3 é¡µé¢å®¹å™¨

ä½¿ç”¨ `.app-container` ç±»ä½œä¸ºé¡µé¢æ ¹å®¹å™¨ï¼Œæä¾›ç»Ÿä¸€çš„å†…è¾¹è·ï¼š

```vue
<template>
  <div class="app-container">
    <!-- é¡µé¢å†…å®¹ -->
  </div>
</template>
```

### 9.4 ç»„ä»¶å‘½åä¸ç¼“å­˜

é¡µé¢éœ€è¦ç¼“å­˜æ—¶ï¼Œå¿…é¡»è®¾ç½® `name` å¹¶åœ¨è·¯ç”± `meta` ä¸­å¼€å¯ `keepAlive`ï¼š

```typescript
// ç»„ä»¶ä¸­
defineOptions({
  name: "ElementPlus"  // å¿…é¡»ä¸è·¯ç”± name ä¸åŒ
})

// è·¯ç”±ä¸­
{
  name: "ElementPlusRoute",
  meta: {
    keepAlive: true  // å¼€å¯ç¼“å­˜
  }
}
```

### 9.5 ç¯å¢ƒå˜é‡

åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨ `VITE_` å‰ç¼€ï¼š

```bash
# .env
VITE_APP_TITLE=V3 Admin Vite
VITE_BASE_URL=/api/v1
VITE_ROUTER_HISTORY=hash
VITE_PUBLIC_PATH=/
```

åœ¨ä»£ç ä¸­ä½¿ç”¨ï¼š

```typescript
const title = import.meta.env.VITE_APP_TITLE
const baseUrl = import.meta.env.VITE_BASE_URL
```

### 9.6 è¯·æ±‚ä»£ç†

å¼€å‘ç¯å¢ƒçš„ API ä»£ç†åœ¨ `vite.config.ts` ä¸­é…ç½®ï¼š

```typescript
server: {
  proxy: {
    "/api/v1": {
      target: "https://your-api-server.com",
      changeOrigin: true,
      rewrite: path => path.replace(/^\/api\/v1/, "")
    }
  }
}
```

### 9.7 æ„å»ºä¼˜åŒ–

é¡¹ç›®å·²é…ç½®ä»£ç åˆ†å‰²ï¼Œæ— éœ€æ‰‹åŠ¨å¤„ç†ï¼š

```typescript
// vite.config.ts
build: {
  rollupOptions: {
    output: {
      manualChunks: {
        vue: ["vue", "vue-router", "pinia"],
        element: ["element-plus", "@element-plus/icons-vue"],
        vxe: ["vxe-table"]
      }
    }
  }
}
```

### 9.8 ç±»å‹å£°æ˜

ä¸ºè‡ªå®šä¹‰çš„å…¨å±€ç±»å‹æ·»åŠ å£°æ˜åˆ° `types/` ç›®å½•ï¼š

```typescript
// types/custom.d.ts
declare global {
  interface Window {
    myGlobalVar: string
  }
}

export {}
```

### 9.9 è¡¨å•æ ¡éªŒ

ä½¿ç”¨ Element Plus çš„è¡¨å•æ ¡éªŒï¼š

```typescript
import type { FormRules } from "element-plus"

const formRules: FormRules = {
  username: [
    { required: true, message: "è¯·è¾“å…¥ç”¨æˆ·å", trigger: "blur" }
  ],
  email: [
    { required: true, message: "è¯·è¾“å…¥é‚®ç®±", trigger: "blur" },
    { type: "email", message: "è¯·è¾“å…¥æ­£ç¡®çš„é‚®ç®±æ ¼å¼", trigger: "blur" }
  ],
  password: [
    { required: true, message: "è¯·è¾“å…¥å¯†ç ", trigger: "blur" },
    { min: 8, max: 16, message: "å¯†ç é•¿åº¦ä¸º 8-16 ä½", trigger: "blur" }
  ]
}
```

### 9.10 å¸¸è§é—®é¢˜

#### Q: è·¯ç”±åˆ‡æ¢åé¡µé¢ç©ºç™½ï¼Ÿ

ç¡®ä¿ç»„ä»¶æ¨¡æ¿æœ‰å•ä¸€æ ¹å…ƒç´ ï¼Œæˆ–æ£€æŸ¥ç»„ä»¶æ˜¯å¦æ­£ç¡®å¯¼å‡ºã€‚

#### Q: é¡µé¢ç¼“å­˜ä¸ç”Ÿæ•ˆï¼Ÿ

æ£€æŸ¥ `defineOptions({ name: "xxx" })` æ˜¯å¦è®¾ç½®ï¼Œä¸”ä¸è·¯ç”± `meta.keepAlive` é…åˆä½¿ç”¨ã€‚

#### Q: æ ·å¼ä¸ç”Ÿæ•ˆï¼Ÿ

1. æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº† `scoped` ä½†éœ€è¦ç©¿é€
2. ä½¿ç”¨ `:deep()` è¿›è¡Œæ ·å¼ç©¿é€
3. æ£€æŸ¥ UnoCSS ç±»åæ˜¯å¦æ­£ç¡®

#### Q: æ¥å£ 401 é”™è¯¯ï¼Ÿ

Token è¿‡æœŸï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µã€‚

---

## é™„å½•ï¼šå¸¸ç”¨é“¾æ¥

- [Vue 3 å®˜æ–¹æ–‡æ¡£](https://cn.vuejs.org/)
- [Vue Router å®˜æ–¹æ–‡æ¡£](https://router.vuejs.org/zh/)
- [Pinia å®˜æ–¹æ–‡æ¡£](https://pinia.vuejs.org/zh/)
- [Element Plus å®˜æ–¹æ–‡æ¡£](https://element-plus.org/zh-CN/)
- [Vxe Table å®˜æ–¹æ–‡æ¡£](https://vxetable.cn/)
- [UnoCSS å®˜æ–¹æ–‡æ¡£](https://unocss.dev/)
- [Vite å®˜æ–¹æ–‡æ¡£](https://cn.vite.dev/)

---

> ğŸ“ **è¯´æ˜**ï¼šæœ¬æ‰‹å†ŒåŸºäºé¡¹ç›®å½“å‰ç‰ˆæœ¬ç¼–å†™ï¼Œå¦‚æœ‰æ›´æ–°è¯·ä»¥å®é™…ä»£ç ä¸ºå‡†ã€‚
